{% capture date %}{{ page.date }}{{ post.date }}{% endcapture %}
{% capture has_date %}{{ date | size }}{% endcapture %}

{% capture date_formatted %}
{% assign d = date | date: "%-d" %}
{% assign m = date | date: "%B" %}

{% case m %}
  {% when 'April' or 'May' or 'June' or 'July' %}{{ m }}
  {% when 'September' %}Sept.
  {% else %}{{ date | date: "%b" }}
  {% endcase %}
{% case d %}
  {% when '1' or '21' or '31' %}{{ d }}st
  {% when '2' or '22' %}{{ d }}nd,
  {% when '3' or '23' %}{{ d }}rd,
  {% else %}{{ d }}th,
  {% endcase %}
{{ date | date: "%Y" }}
{% endcapture %}

{% if has_date != '0' %}
{% capture time %}<time datetime="{{ date | datetime | date_to_xmlschema }}" class="published"{% if updated %} data-updated="true"{% endif %}>{{ date_formatted }}</time>{% endcapture %}
{% endif %}

